<!DOCTYPE html>
<html lang="en">
	<head>
	    <script type='text/javascript' src="Scripts/jquery-1.8.3.min.js"></script>
	    <script type='text/javascript' src="Scripts/jquery-ui-1.9.2.min.js"></script>
   	    <script src="Scripts/ajaxWrapper.js"></script>
    	<link rel="stylesheet" type="text/css" href="Styles/jquery-ui.css" />	    <link rel="stylesheet" type="text/css" href="Styles/Site.css" />
	    <meta charset="utf-8">
	    <title>Raven test</title>
	    <meta name="description" content="Template Description">
	
        <script type="text/javascript">
            $(function () {
                $("#startDate").datepicker({ dateFormat: "yy,mm,dd" });                $("#endDate").datepicker({ dateFormat: "yy,mm,dd" });
                // Loading for edit
		        // postData("WebService/RavenDB.asmx/GetEvent", queryOptions(), populateForm);
		    });
            /* 
            // The ID of the one to edit (get back)
		    function queryOptions() {
		        var myOptions =
                        {
                            "eventId": "1"
                        };
		        return myOptions;
		    }
            */
		    function saveForm() {
		    
		        // Saver nå ved å sende serialized form
		        // MEN jeg skal lage et JSON obj og sende dette med postData til en
		        // save i WS som tar imot event obj og lager direkte

		        var $form = $("form input:text"); //.serialize();
		        
                
		        postData("WebService/RavenDB.asmx/Save", makeEventJson($form), writeDebug);
		    }

		    function writeDebug(json) {
		        $("#testdiv").text(json);
		    }
		    

		    function makeEventJson(data) {
		        var jsonObj =
		        {
		            "headline": data[0].value,
		            "text": data[1].value,
		            "asset": {
		                "media": data[2].value,
		                "credit": data[3].value,
		                "caption": data[4].value
		            },
		            "startDate": data[5].value,
		            "endDate": data[6].value
		        };
		        return jsonObj;
		    //    return JSON.stringify(jsonObj);
            }




	    </script>

    </head>

	<body>

		<form>
        <div>
    
         <table>
	    <tr>
		    <td>Headline</td><td><input type="text" name="headline" maxlength="100" style="width:300px" /></td>
	    </tr><tr>
		    <td>Text</td><td><input type="text" name="text" maxlength="255" style="width:300px" /></td>
	    </tr><tr>
		    <td>Media url</td><td><input type="text" name="media" maxlength="255" style="width:300px" /></td>
	    </tr><tr>
		    <td>Credit</td><td><input type="text" name="credit" maxlength="100" style="width:300px" /></td>
	    </tr><tr>
		    <td>Caption</td><td><input type="text" name="caption" maxlength="100" style="width:300px" /></td>
	    </tr><tr>
		    <td>Start date</td><td><input type="text" name="startDate" id="startDate" /></td>
	    </tr><tr>
		    <td>End date</td><td><input type="text" name="endDate" id="endDate" /></td>
	    </tr></table>
    
	        <input type="button" name="save" value="save" onclick="saveForm()">

		    <div id="testdiv"></div>
        </div>
    </form>
	</body>
</html>
			
